class Solution {
    public String reorganizeString(String S) {
        int[] charCount = new int[26];
        for (char ch : S.toCharArray()) {
            charCount[ch - 'a'] += 100;
        }
        for (int i = 0; i < 26; i++) {
            charCount[i] += i;
        }
        Arrays.sort(charCount);
        
        int len = S.length();
        char[] ans = new char[len];
        int index = 1;
        
        for (int code : charCount) {
            int count = code / 100;
            if (count > (len + 1) / 2) {
                return "";
            }
            char ch = (char)('a' + (code % 100));
            
            for (int i = 0; i < count; i++) {
                if (index > len - 1) {
                    index = 0;
                }
                
                ans[index] = ch;
                index += 2;
            }
        }
        
        return String.valueOf(ans);
    }
}
